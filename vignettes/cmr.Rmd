---
title: "CMR"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(cmR)
```

## Simulate cmr data

We use a simulated data set and add random white noise.

```{r simulate, cache=TRUE}
data(sim)

for (i in 1:dim(data)[1])
for (j in 1:dim(data)[2])
for (k in 1:3)
if (!is.na(data[i,j,k,1]))
data[i,j,k,]=data[i,j,k,]+rnorm(30,0,sqrt(30))
```

Let's have a look on the data:
```{r showdata, cache=TRUE}
imageMBF(data[,,,1])
imageMBF(data[,,,10])
imageMBF(data[,,,20])
imageMBF(data[,,,30])
```

## Analysis

```{r localanalysis, cache=TRUE}
print(system.time({local=cmr(data,aif,method="local",cores=2)}))
imageMBF(local$mbf,zlim=c(0,5))
imageMBF(local$ci,zlim=c(0,.8))
```

```{r spatialanalysis, cache=TRUE}
print(system.time({spatial=cmr(data,aif,method="spatial",cores=2)}))
pseudobullseye(space$mbf,lim=c(0,5))
pseudobullseye(space$ci,lim=c(0,5))
pseudobullseye(resp,lim=c(0,5))
```


