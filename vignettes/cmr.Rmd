---
title: "CMR"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(cmR)
```

## Simulate cmr data

We use a simulated data set and add random white noise.

```{r simulate, cache=TRUE}
data(sim)

for (i in 1:dim(data)[1])
for (j in 1:dim(data)[2])
for (k in 1:3)
if (!is.na(data[i,j,k,1]))
data[i,j,k,]=data[i,j,k,]+rnorm(30,0,sqrt(30))
```

Let's have a look on the data:
```{r showdata, cache=TRUE}
imageMBF(data[,,,1])
imageMBF(data[,,,10])
imageMBF(data[,,,20])
imageMBF(data[,,,30])
```

## Analysis

```{r analysis, cache=TRUE}
local=cmr(data,aif,method="local")
spatial=cmr(data,aif,method="spatial")

image.mbf(resp,zlim=c(0,5))
image.mbf(space$mbf,zlim=c(0,5))
image.mbf(local$mbf,zlim=c(0,5))
```


image.mbf(space$ci,zlim=c(0,.8))

image.mbf(local$ci,zlim=c(0,.8))


par(fin=10*c(dim(resp[,,1])/max(dim(resp[,,1]))))
par(mai=c(0,0,0,0))
par(cex=2)
image.plot(resp[,,1],zlim=c(0,5),legend.only=TRUE,legend.width=3.5)

image.mbf(space.mbf,zlim=c(0,5))

image.mbf(local.mbf,zlim=c(0,5))

image.mbf(space.ci,zlim=c(0,.8))

image.mbf(local.ci,zlim=c(0,.8))



```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
